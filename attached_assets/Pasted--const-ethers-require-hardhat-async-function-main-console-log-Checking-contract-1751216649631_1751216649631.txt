
const { ethers } = require("hardhat");

async function main() {
  console.log("ðŸ” Checking contract deployment...\n");

  const contractAddress = "0xc0d5045879B6d52457ef361FD4384b0f08A6B64b";
  const [signer] = await ethers.getSigners();

  console.log("ðŸ“‹ Connection Details:");
  console.log("- Network:", (await ethers.provider.getNetwork()).name);
  console.log("- Chain ID:", (await ethers.provider.getNetwork()).chainId);
  console.log("- Signer:", signer.address);
  console.log("- Signer Balance:", ethers.formatEther(await ethers.provider.getBalance(signer.address)), "ETH");

  console.log("\nðŸ” Contract Check:");
  console.log("- Target Address:", contractAddress);

  try {
    // Check if contract exists
    const code = await ethers.provider.getCode(contractAddress);
    console.log("- Code Length:", code.length);
    
    if (code === "0x") {
      console.log("âŒ No contract deployed at this address");
      console.log("\nðŸ’¡ Possible solutions:");
      console.log("1. Deploy the contract first: npx hardhat run scripts/deploy-enhanced-sepolia.js --network sepolia");
      console.log("2. Check if you're on the correct network (Sepolia)");
      console.log("3. Verify the contract address is correct");
    } else {
      console.log("âœ… Contract found at address");
      
      // Try to get basic info
      try {
        const WalletPlanner = await ethers.getContractFactory("WalletPlanner");
        const contract = WalletPlanner.attach(contractAddress);
        
        const name = await contract.name();
        console.log("âœ… Contract name:", name);
        console.log("ðŸŽ‰ Contract is working correctly!");
        
      } catch (abiError) {
        console.log("âš ï¸  Contract found but ABI mismatch:", abiError.message);
        console.log("\nðŸ’¡ This might mean:");
        console.log("1. The contract at this address is different from expected");
        console.log("2. The contract needs to be compiled: npx hardhat compile");
      }
    }

  } catch (error) {
    console.error("âŒ Network error:", error.message);
    console.log("\nðŸ’¡ Check your network connection and Hardhat configuration");
  }
}

main()
  .then(() => process.exit(0))
  .catch((error) => {
    console.error(error);
    process.exit(1);
  });
